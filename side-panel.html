<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="side-panel.css">
  <link rel="stylesheet" href="util/konsol.css">
  <title>Local Browser AI - Side Panel</title>
</head>
<body>
    <div class="button-bar">
        <button id="reload-button">Reload</button>
        <button id="close-button">Close</button>
    </div>
    <div id="api-status">Checking availability...</div>
    <div id="prompt-api-ui" hidden>
        <fieldset id="prompt-api-init">
            <legend>Prompt API</legend>
            <label for="option-language">Language</label>
            <select id="option-language">
                <option value="en" selected>English</option>
                <option value="es">Spanish</option>
                <option value="ja">Japanese</option>
            </select>
            <label for="option-system-prompt">System Prompt</label>
            <textarea id="option-system-prompt">You are a funny joke teller</textarea>
            <br>
            <fieldset>
                <legend>Options</legend>
                <label for="option-temperature">Temperature</label>
                <input type="range" id="option-temperature" min="0" max="1"  value="0.1" step="0.1"/>
                <label for="option-top-k">Top K</label>
                <input type="range" id="option-top-k" min="1" max="128"  value="3" step="1" />
            </fieldset>
            <hr class="spacer spacer--4" />
            <div class="button-bar">
                <div id="init-loading-animation" class="loading-animation" hidden></div>
                <button id="init-button" class="cta">Initialize</button>
            </div>
            
            <progress id="download-progress" min="0" max="1" value="0" hidden></progress>
            <span id="download-eta"></span>
            <button id="init-stop-button" hidden>Stop</button>
        </fieldset>
        <div id="session-established" hidden>
            <div id="chat-placeholder" class="chat-placeholder">
                <img src="images/icon-128.png" alt="Logo" />
                <div class="chat-placeholder__welcome">How can I help you?</div>
                <div class="chat-placeholder__prompt-suggestions">
                    <button>What can you help me with?</button>
                    <button>What's in your training data?</button>
                    <button>Write a poem about AI.</button>
                </div>
            </div>
            <div id="chat-history" class="chat-container"></div>
            <div id="chat-loading-animation" class="loading-animation" hidden></div>
            <div class="prompt-section">
                <textarea id="prompt-input" placeholder="Type your prompt here...">Tell me a joke.</textarea>
                <div class="prompt-controls">
                    <div title="Tokens">
                        <span class="stat" title="Prompt Tokens">
                            P
                            <span id="prompt-tokens" class="value">?</span>
                            <span class="unit">tok</span>
                        </span>
                        <span class="stat" title="Input Usage">
                            U
                            <span id="input-usage" class="value">?</span>
                            <span class="unit">tok</span>
                        </span>
                        <span class="stat" title="Input Quota">
                            Q
                            <span id="input-quota" class="value">?</span>
                            <span class="unit">tok</span>
                        </span>
                        <br>
                        <meter id="usage-ratio" title="Remaining Quota" value="0" low="0.1" high="0.9" optimum="0"></meter>
                        <br>
                        <span class="stat" title="Duration">
                            D
                            <span id="duration" class="value">?</span>
                            <span class="unit">ms</span>
                        </span>
                        <span class="stat" title="Time to first token">
                            TTF
                            <span id="time-to-first-token" class="value">?</span>
                            <span class="unit">ms</span>
                        </span>
                        <span class="stat" title="Token/s">
                            TPS
                            <span id="token-per-second" class="value">?</span>
                            <span class="unit">tok/s</span>
                        </span>
                    </div>
                    <div class="prompt-controls__actions">
                        <label for="option-streaming">
                            <input type="checkbox" id="option-streaming" checked />
                            Streaming
                        </label>
                        <button id="submit-prompt-button" class="cta">Submit</button>
                        <button id="stop-prompt-button" hidden>Stop</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <ul>
            <li><a href="https://blog.alexewerlof.com/p/local-browser-ai" target="_blank">Intro</a></li>
            <li><a href="https://github.com/alexewerlof/local-browser-ai" target="_blank">Github</a></li>
            <li><a href="https://github.com/alexewerlof/local-browser-ai/issues" target="_blank">Issues</a></li>
            <li><a href="https://github.com/alexewerlof/local-browser-ai/blob/main/privacy.txt" target="_blank">Privacy</a></li>
        </ul>
        <img src="images/swedish-flag.svg" alt="Swedish Flag" class="flag"> Made in Sweden
        <br>
        <a href="https://alexewerlof.com" target="_blank">
            <img src="images/logo.png" class="logo">
        </a>
    </footer>
    <div id="log-container"></div>
    <script type="module" src="side-panel.js"></script>
</body>
</html>